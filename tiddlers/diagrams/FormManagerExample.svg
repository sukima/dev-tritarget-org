<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="675px" preserveAspectRatio="none" style="width:1184px;height:675px;" version="1.1" viewBox="0 0 1184 675" width="1184px" zoomAndPan="magnify"><defs><filter height="300%" id="fwthn3bpkkryz" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="589" cy="18" fill="#000000" filter="url(#fwthn3bpkkryz)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fwthn3bpkkryz)" height="572.4883" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="1166" x="6" y="88"/><rect fill="#FFFFFF" height="540" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="1160" x="9" y="117.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="6" x2="1172" y1="114.4883" y2="114.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="126" x="526" y="106.5352">RuleFormManager</text><!--MD5=[bd17e12f1255cf27eab57ce247a4f78b]
cluster AddressFamily--><rect fill="#FEFECE" filter="url(#fwthn3bpkkryz)" height="469.72" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="391" x="41" y="151.7683"/><rect fill="#FFFFFF" height="437.2317" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="385" x="44" y="181.2566"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="41" x2="432" y1="178.2566" y2="178.2566"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="186.5" y="169.3034">AddressFamily</text><ellipse cx="75" cy="278.4883" fill="#000000" filter="url(#fwthn3bpkkryz)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fwthn3bpkkryz)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="55" x="103.5" y="253.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="103.5" x2="158.5" y1="279.9766" y2="279.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="35" x="113.5" y="272.0234">none</text><rect fill="#FEFECE" filter="url(#fwthn3bpkkryz)" height="78.8867" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="184" x="220" y="371.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="220" x2="404" y1="397.9766" y2="397.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="22" x="301" y="390.0234">ip4</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="164" x="225" y="414.5781">entry / setFamilyPickerToIP4</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="138" x="225" y="428.7109">entry / resetIP4Address</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="134" x="225" y="442.8438">exit / cacheIP4Address</text><rect fill="#FEFECE" filter="url(#fwthn3bpkkryz)" height="78.8867" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="184" x="129" y="518.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="129" x2="313" y1="544.9766" y2="544.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="22" x="210" y="537.0234">ip6</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="164" x="134" y="561.5781">entry / setFamilyPickerToIP6</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="138" x="134" y="575.7109">entry / resetIP6Address</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="134" x="134" y="589.8438">exit / cacheIP6Address</text><!--MD5=[564cb34081e615d6de26891e55a3d431]
link *start*AddressFamily to none--><path d="M85.06,278.4883 C89.45,278.4883 93.83,278.4883 98.22,278.4883 " fill="none" id="*start*AddressFamily-&gt;none" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="103.37,278.4883,94.37,274.4883,98.37,278.4883,94.37,282.4883,103.37,278.4883" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[daaf290b1b042f62735c473b4363bada]
link none to ip4--><path d="M115.95,303.5583 C108.2,319.3383 102.52,339.5483 114,353.4883 C140.48,385.6583 165.85,360.3383 206,371.4883 C208.83,372.2783 211.69,373.0983 214.57,373.9583 " fill="none" id="none-&gt;ip4" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="219.78,375.5383,212.3353,369.0902,214.9968,374.0819,210.0051,376.7434,219.78,375.5383" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="121.5" y="335.0566">PICK_PROTOCOL</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="115" y="350.3672">[isProtocolICMPv4]</text><!--MD5=[f866665666920386fc192c937e16b238]
link none to ip6--><path d="M112.81,303.4883 C109.13,309.1683 105.61,315.3583 103,321.4883 C80.47,374.4383 72.31,396.4183 92,450.4883 C101.64,476.9483 122.48,498.6383 144.66,515.3883 " fill="none" id="none-&gt;ip6" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="148.82,518.4583,143.966,509.8887,144.8012,515.4835,139.2063,516.3187,148.82,518.4583" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="99.5" y="408.5566">PICK_PROTOCOL</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="93" y="423.8672">[isProtocolICMPv6]</text><!--MD5=[d412c6f231561c9c707ba23081f8c00b]
link ip4 to ip6--><path d="M219.91,445.8483 C215.22,447.4483 210.56,448.9983 206,450.4883 C178.72,459.3883 161.23,445.5483 144,468.4883 C132.27,484.0983 140.13,500.4383 154.55,514.7583 " fill="none" id="ip4-&gt;ip6" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="158.35,518.3483,154.5565,509.2593,154.7161,514.9139,149.0615,515.0735,158.35,518.3483" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="151.5" y="482.0566">PICK_PROTOCOL</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="145" y="497.3672">[isProtocolICMPv6]</text><!--MD5=[157e78fda154bc46625697bfa8c5ba05]
link ip6 to ip4--><path d="M250.84,518.2583 C255.05,512.3983 259.23,506.3483 263,500.4883 C272.31,486.0383 281.67,469.6983 289.67,455.0383 " fill="none" id="ip6-&gt;ip4" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="292.11,450.5383,284.3038,456.5435,289.7267,454.9337,291.3365,460.3567,292.11,450.5383" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="288.5" y="482.0566">PICK_PROTOCOL</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="282" y="497.3672">[isProtocolICMPv4]</text><!--MD5=[99dacb76e6c73d1fd2dfcc99323fd09e]
link AddressFamily to ip4--><path d="M239,179.5383 C238.91,181.7083 236.39,251.4783 253,303.4883 C260,325.3883 271.7,347.9083 282.85,366.5683 " fill="none" id="AddressFamily-&gt;ip4" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="285.67,371.2283,284.4311,361.4576,283.0807,366.9509,277.5874,365.6005,285.67,371.2283" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="254" y="276.0566">PICK_FAMILY</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="255" y="291.3672">[isFamilyIP4]</text><!--MD5=[0007cd71d1fa076939879717ed39d237]
link AddressFamily to ip6--><path d="M239.04,179.5083 C240.92,180.1883 301.34,202.2183 336,237.4883 C342.02,243.6083 410.79,363.1883 413,371.4883 C422.05,405.4083 416.12,415.5183 413,450.4883 C410.99,472.9783 418.97,483.5883 404,500.4883 C382.14,525.1783 349.74,539.2183 318.26,547.1583 " fill="none" id="AddressFamily-&gt;ip6" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="313.21,548.3783,322.897,550.1567,318.0706,547.206,321.0213,542.3797,313.21,548.3783" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="404" y="335.0566">PICK_FAMILY</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="405" y="350.3672">[isFamilyIP6]</text><!--MD5=[ff820fd13ba5bac357199ffed5e471f5]
link AddressFamily to none--><path d="M238.93,179.4883 C236.16,179.4783 147.44,179.4583 132,197.4883 C120.29,211.1583 120.18,231.4883 122.93,248.2383 " fill="none" id="AddressFamily-&gt;none" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="123.86,253.3083,126.1463,243.7285,122.9455,248.3926,118.2813,245.1917,123.86,253.3083" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="142.5" y="211.0566">PICK_FAMILY</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="133" y="226.3672">[canSelectNone]</text><line style="stroke: #A80036; stroke-width: 1.5; stroke-dasharray: 8.0,10.0;" x1="504" x2="504" y1="119.4883" y2="663.4883"/><!--MD5=[01f992b2fa8adb612cc7da5577f74dfd]
cluster Protocol--><rect fill="#FEFECE" filter="url(#fwthn3bpkkryz)" height="351.72" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="581" x="534" y="151.7683"/><rect fill="#FFFFFF" height="319.2317" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="575" x="537" y="181.2566"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="534" x2="1115" y1="178.2566" y2="178.2566"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="796" y="169.3034">Protocol</text><ellipse cx="636" cy="292.9883" fill="#000000" filter="url(#fwthn3bpkkryz)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fwthn3bpkkryz)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="50" x="558" y="267.9883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="558" x2="608" y1="294.4766" y2="294.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="24" x="571" y="286.5234">any</text><rect fill="#FEFECE" filter="url(#fwthn3bpkkryz)" height="78.8867" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="212" x="664" y="253.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="664" x2="876" y1="279.9766" y2="279.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="749" y="272.0234">icmp4</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="192" x="669" y="296.5781">entry / setProtocolPickerToICMP4</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="132" x="669" y="310.7109">entry / lockFamilyNone</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="138" x="669" y="324.8438">exit / unlockFamilyNone</text><rect fill="#FEFECE" filter="url(#fwthn3bpkkryz)" height="78.8867" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="212" x="740" y="400.4883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="740" x2="952" y1="426.9766" y2="426.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="825" y="419.0234">icmp6</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="192" x="745" y="443.5781">entry / setProtocolPickerToICMP6</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="132" x="745" y="457.7109">entry / lockFamilyNone</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="138" x="745" y="471.8438">exit / unlockFamilyNone</text><rect fill="#FEFECE" filter="url(#fwthn3bpkkryz)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="57" x="894.5" y="267.9883"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="894.5" x2="951.5" y1="294.4766" y2="294.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="904.5" y="286.5234">other</text><!--MD5=[3a4996dc7b6cda604d36ec033917cbd6]
reverse link any to *start*Protocol--><path d="M613.41,292.9883 C617.47,292.9883 621.53,292.9883 625.6,292.9883 " fill="none" id="any&lt;-*start*Protocol" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="608.26,292.9883,617.26,296.9883,613.26,292.9883,617.26,288.9883,608.26,292.9883" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[93edbb3e106c1d118b4d87580f967e26]
link icmp4 to icmp6--><path d="M750.83,332.8583 C745.64,349.0283 743.51,367.4783 752,382.4883 C754.93,387.6683 758.54,392.4283 762.63,396.7883 " fill="none" id="icmp4-&gt;icmp6" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="766.18,400.3583,762.6816,391.1517,762.6588,396.8085,757.0019,396.7857,766.18,400.3583" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="753" y="364.0566">PICK_FAMILY</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="754" y="379.3672">[isFamilyIP6]</text><!--MD5=[8c5e6f77fc137e22f28e48e2a3801779]
reverse link icmp4 to icmp6--><path d="M825.68,336.6583 C829.24,341.0183 832.42,345.6383 835,350.4883 C843.01,365.5183 846.16,383.9783 847.16,400.1283 " fill="none" id="icmp4&lt;-icmp6" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="822.32,332.7283,825.1401,342.1648,825.574,336.5246,831.2141,336.9584,822.32,332.7283" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="845" y="364.0566">PICK_FAMILY</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="846" y="379.3672">[isFamilyIP4]</text><!--MD5=[e46851449adc7c612ac37582ccd1f856]
link Protocol to icmp4--><path d="M804.96,179.4883 C803.13,179.6583 744.69,184.9983 735,197.4883 C723.44,212.3983 727.83,231.5183 736.79,248.6583 " fill="none" id="Protocol-&gt;icmp4" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="739.43,253.4383,738.5558,243.6283,737.0018,249.0675,731.5626,247.5134,739.43,253.4383" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="742.5" y="211.0566">PICK_PROTOCOL</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="736" y="226.3672">[isProtocolICMPv4]</text><!--MD5=[9905e6a3406f2ee80ecdbd4aab361abb]
link Protocol to icmp6--><path d="M805.12,179.4883 C810.11,179.5883 969.88,182.9683 983,197.4883 C1040.27,260.8483 989.98,320.7183 931,382.4883 C926.13,387.5883 920.72,392.4683 915.05,397.0783 " fill="none" id="Protocol-&gt;icmp6" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="911.09,400.2283,920.6288,397.7764,915.0096,397.124,915.662,391.5049,911.09,400.2283" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="1015.5" y="290.5566">PICK_PROTOCOL</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="1009" y="305.8672">[isProtocolICMPv6]</text><!--MD5=[634a7db15ef60849f16f6245aa5d3694]
link Protocol to any--><path d="M804.88,179.4883 C799.71,179.6583 634.28,184.9583 618,197.4883 C597.98,212.8983 589.41,240.9983 585.74,262.5683 " fill="none" id="Protocol-&gt;any" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="584.95,267.6183,590.29,259.3427,585.721,262.6781,582.3857,258.1091,584.95,267.6183" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="619" y="211.0566">PICK_PROTOCOL</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="623.5" y="226.3672">[isProtocolAny]</text><!--MD5=[9f796c2f7a8f13b9d36324cc5454cbad]
link Protocol to other--><path d="M805.09,179.4983 C806.9,179.7483 836.11,183.8883 854,197.4883 C867.95,208.0883 865.66,216.1383 877,229.4883 C880.26,233.3183 881.77,233.6283 885,237.4883 C891.87,245.6983 898.76,255.1183 904.74,263.7883 " fill="none" id="Protocol-&gt;other" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="907.6,267.9783,905.8359,258.2887,904.7838,263.8468,899.2256,262.7947,907.6,267.9783" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="878" y="218.5566">PICK_PROTOCOL</text><!--MD5=[e5c88a6d12509aa90dc4efd29076b87b]
link *start to RuleFormManager--><path d="M589,28.11 C589,38.82 589,58.27 589,82.69 " fill="none" id="*start-&gt;RuleFormManager" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="589,87.97,593,78.97,589,82.97,585,78.97,589,87.97" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[34d7abb0cb70c3eee9d76ddd9340c31e]
@startuml

[*] - -> RuleFormManager

state RuleFormManager {

  state AddressFamily {
    [*] -> none
    ip4 : entry / setFamilyPickerToIP4
    ip4 : entry / resetIP4Address
    ip4 : exit / cacheIP4Address
    ip6 : entry / setFamilyPickerToIP6
    ip6 : entry / resetIP6Address
    ip6 : exit / cacheIP6Address
    none - -> ip4 : PICK_PROTOCOL\n[isProtocolICMPv4]
    none - -> ip6 : PICK_PROTOCOL\n[isProtocolICMPv6]
    ip4 - -> ip6 : PICK_PROTOCOL\n[isProtocolICMPv6]
    ip6 - -> ip4 : PICK_PROTOCOL\n[isProtocolICMPv4]
    AddressFamily - -> ip4 : PICK_FAMILY\n[isFamilyIP4]
    AddressFamily - -> ip6 : PICK_FAMILY\n[isFamilyIP6]
    AddressFamily - -> none : PICK_FAMILY\n[canSelectNone]
  }

  ||

  state Protocol {
    [*] -l-> any
    icmp4 : entry / setProtocolPickerToICMP4
    icmp4 : entry / lockFamilyNone
    icmp4 : exit / unlockFamilyNone
    icmp6 : entry / setProtocolPickerToICMP6
    icmp6 : entry / lockFamilyNone
    icmp6 : exit / unlockFamilyNone
    icmp4 -d-> icmp6 : PICK_FAMILY\n[isFamilyIP6]
    icmp6 -u-> icmp4 : PICK_FAMILY\n[isFamilyIP4]
    Protocol - -> icmp4 : PICK_PROTOCOL\n[isProtocolICMPv4]
    Protocol - -> icmp6 : PICK_PROTOCOL\n[isProtocolICMPv6]
    Protocol - -> any : PICK_PROTOCOL\n[isProtocolAny]
    Protocol - -> other : PICK_PROTOCOL
  }

}

@enduml

PlantUML version 1.2020.05(Thu Mar 19 17:17:32 EDT 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 13.0.2+8
Operating System: Mac OS X
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>